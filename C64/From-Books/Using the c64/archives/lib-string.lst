               ;---------------------------------------               ;---------------------------------------               ; Fichier.: lib-string.l (seq)               ; Auteur..: Daniel Lafrance               ; Version.: 0.0.2               ; Revision: 20251119,20251121               ;---------------------------------------               ; Description:               ; Routines d'affichage de chaines de               ; caracteres se terminant par $00 sans               ; recours au rom du Basic 2.0.               ;---------------------------------------               ;---------------------------------------               ; puts entres:               ;  Pointeur de chaine $FCFB               ; Desc. Affichage Kernal d'une chaine.               ;---------------------------------------               puts                        .block1000 08                 php        ;Sauve. registres1001 48                 pha        ; ...1002 98                 tya        ; ...1003 48                 pha        ; ...1004 a0 00              ldy #$00   ; Y = offset1006 b1 fb     nextc    lda ($fb),y;lit un caractere1008 f0 07              beq out    ;si 0 on sort100a 20 d2 ff           jsr $ffd2  ;On l'affiche100d c8                 iny        ;Pointe le prochain100e 4c 06 10           jmp nextc  ; et l'affiche1011 68        out      pla        ;Recup. registres1012 a8                 tay        ; ...1013 68                 pla        ; ...1014 28                 plp        ; ...1015 60                 rts                        .bend               ;---------------------------------------               ; putstrz input:               ;  Pointeur de chaine $YYXX               ;---------------------------------------               putsyx                        .block1016 00                 jsr pushall;Sauve reg + zps1017 86 fb              stx $fb    ;$YYXX dans1019 84 fc              sty $fb+1  ; zp1101b 20 00 10           jsr puts101e 00                 jsr popall ;Recup reg + zps101f 60                 rts                        .bend               ;---------------------------------------               ; putstrzc input:               ;  Pointeur de chaine $FCFB, Couleur A               ;---------------------------------------               putsc                        .block1020 08                 php        ;Flag sur stack1021 48                 pha        ;Acc sur stack1022 48                 pha        ;Sauvegarde acc1023 00                 lda kcol   ;Recup coul. carac.1024 00                 sta curcol ; et la sauvegarde1025 68                 pla        ;Recup. Acc1026 00                 sta kcol   ;Place coul. voulue1027 20 00 10           jsr puts   ;Affiche la chaine102a 00                 lda curcol ;Recup coul. carac.102b 00                 sta kcol   ; et la replace102c 68                 pla        ;Recup Acc102d 28                 plp        ;Recup flag102e 60                 rts                        .bend               ;---------------------------------------               ; putscxy input:               ;  Pointeur de chaine $YYXX, Couleur A               ;---------------------------------------               putxcxy                        .block102f 08                 php       ;Sauve registres1030 48                 pha       ; ...1031 48                 pha       ;Sauve Acc1032 00                 lda kcol  ;Recup couleur carac.1033 00                 sta curcol; et sauvegarde1034 68                 pla       ;Recup Acc1035 00                 sta kcol  ;Place couleur carac.1036 20 16 10           jsr putsyx;Affiche la chaine1039 00                 lda curcol103a 00                 sta kcol103b 68                 pla103c 28                 plp103d 60                 rts                        .bend               ;---------------------------------------