;---------------------------------------; nom fichier..: prog.asm; type fichier.: source pour t.m.p.; auteur.......: daniel lafrance; version......: 20151125; revision.....: 0.0.2;---------------------------------------        .include "m-utils.asm"        .include "e-vars.asm"        .include "e-float.asm"        .include "e-64map.asm"        .include "l-bashead.asm";---------------------------------------main        .block        #outcar 14 ;Force maj/minuscule        #outcar 8  ;Bloque Carset chang.        ldy #$00        ldx #$00        jsr ramprobe        rts        .bend;---------------------------------------ramprobe        .block        jsr pushregs        jsr clrkbbuf        #styxptr dumpadr        #outcar 147        #locate 1,0        #outstr dmphead         #locate 1,1        #outstr dmphead2         #locate 1,20        #outstrxy menu0        #outstrxy menu1        #outstrxy menu2        #outstrxy menu3        #outstrxy menu4        #outstrxy menu5        #outstrxy menu6        jmp doitarr1k   dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1        dec dumpadr+1arr512  dec dumpadr+1arr256  #ldyxptr dumpadr        lda #128        jsr subatoyx         #styxptr dumpadrarr128  dec dumpadr+1        jmp doitava1k   inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1        inc dumpadr+1ava512  inc dumpadr+1ava256  clc        lda dumpadr        adc #$80        bcc ava128        inc dumpadr+1           sta dumpadrava128doit    #locate 1,1        lda #16        ldyxptr dumpadr        jsr memdumpmorekey jsr getkey        ;#locate 39-11,24        ;jsr chrout        ;#outcar 32        ;#outcar 36        ;jsr putahexdecchkf1   cmp #133   ; touche [F1]        bne chkf2         jmp doit   ; +128     chkf2   cmp #137   ; touche [F2]        bne chkf3         jmp arr128 ;-128chkf3   cmp #134   ; touche [F3]        bne chkf4        jmp ava256 ;+256chkf4   cmp #138   ; touche [F4]        bne chkf5        jmp arr256 ;-256chkf5   cmp #135        bne chkf6        jmp ava512 ;+512 chkf6   cmp #139        bne chkf7        jmp arr512 ;-512chkf7   cmp #136        bne chkf8        jmp ava1k  ;+1024chkf8   cmp #140        bne chk20        jmp arr1k  ;-1024chk20   cmp #$20   ; touche espace        bne chkq        jmp doitchkq    cmp #$51   ; touche q        beq quitter        jmp morekeyquitter jsr popregs        #drawbox 5,5,30,10,5,"Adresse"        jsr getkey        #outcar 147        #locate 0,0        rts        .bend;--------------------------------------- ; Affiche le contenue memoire a la ; maniere de supermon par ligne 8; octets.; $yyxx contiennent l'adresse de depart;  $FFFF pour continuer la ou il etait.; acc. contien le nombre de ligne a ; afficher.      memdump         .block        sta nligne        sta loops        cpy #$ff        bne nouvel        cpx #$ff        bne nouvel        jmp memeadrnouvel  sty dumpadr+1   ;*        pha        txa        and #$f8        tax        pla        stx dumpadr     ;*        jsr yxtoptrmemeadr again   ldy dumpadr+1   ;*        ldx dumpadr     ;*        jsr yxtoptr        lda #$08        #outcar $0d        jsr bytestohex        jsr incptr8        jsr ptrtoyx                sty dumpadr+1   ;*        stx dumpadr     ;*        dec loops        bne again        rtsnligne  .byte $16        .benddumpadr .word $f000;---------------------------------------putahexdec        .block        jsr pushregs        #outcar kjaune        jsr putahex        #outcar $20        #outcar kcyan        tax        lda #$00        jsr fiaxtf1        jsr popregs        rts        .bend;---------------------------------------; entree: x=colonne y=ligne (bmp)calcdot        .block        jsr pushall        tya     ;y contien la ligne        lsr a   ; on divise par 8        lsr a        lsr a        sta row ; et on sauvegarde        txa     ;x contien la colonne        lsr a   ; on divise par 8        lsr a        lsr a        sta col ; et on sauvegarde        tya     ; masque avec 7 donne        and #$07; la ligne caractere        sta lin ; du pixel.        txa     ;7-(x and 7) donne le        and #$07; no du bit de l'octet        sta sbit; du pixel.        lda #$07        sec        sbc sbit        sta sbit        ;------------------------------        ; inserer calcul adresse ici        ;------------------------------        ;ldx #$00        ;lda #$02        ;jsr fiaxtf1        ;#outcar $0d                 jsr popall        rts        .bend;---------------------------------------floattest;---------------------------------------        .block        php        pha        lda #$07        sta kcol        ;jsr getfac1        ldy sbit        jsr fiyytf1        jsr prnfac1        ;lda #$03        ;sta kcol        ;jsr prnfac1        ;lda #$01        ;sta kcol        pla        plp        rts        .bend;---------------------------------------        .include "l-push.asm"        .include "l-mem.asm"        .include "l-conv.asm"        .include "l-string.asm"        .include "l-float.asm"        .include "l-keyb.asm"        .include "l-math.asm"        .include "l-bitmap.asm"        .include "l-drawbox.asm"        .include "progvars.asm" ;---------------------------------------