
; 64tass Turbo Assembler Macro V1.54.1900 listing file
; 64tass -C -m -a -I /Users/Locals/C64/00-usbkey32go/d-00-64tass-src/lib -i -L prog.txt -o prog.prg prog.asm
; Tue Dec  2 23:53:12 2025

;Offset	;Hex		;Source

;******  Processing input file: prog.asm


;******  Processing file: e-vars.asm

=$02a7			rp       = $02a7 ; byte
=$02a8			ra       = $02a8 ; byte
=$02a9			pc       = $02a9 ; word
=$02ab			curcol   = $02ab ; coul. kernal sauvee
=$02ac			freevar  = $02ac ; non utilisee

;******  Return to file: prog.asm


;******  Processing file: e-float.asm

=$bba2			ffvtf1   = $bba2 ;copie fv $(yyxx) to f1
=$ba8c			ffvtf2   = $ba8c ;copie fv $(yyxx) to f2
=$bbd0			ff1t49   = $bbd0 ;copie f1 to $49.
=$bbd4			ff1tyx   = $bbd4 ;copie f1 to (yyxx).
=$bbc7			ff1t5c   = $bbc7 ;copie f1 to $5c-$60
=$bbca			ff1t57   = $bbca ;copie f1 to $57-$5b
=$bbfc			ff2tf1   = $bbfc ;copie f2 to f1
=$bc0c			ff1tf2   = $bc0c ;copie f1 to f2
=$b86a			ff2pf1   = $b86a ;f1=f2+f1
=$bd7e			ff1pac   = $bd7e ;f1=f1+ra=(0-9)
=$b867			ffvpf1   = $b867 ;f1=fv+f1 ($yyaa)
=$b853			ff2sf1   = $b853 ;f1=f2-f1
=$b850			ffvsf1   = $b850 ;f1=fv-f1 ($yyaa)
=$b849			ff1p05   = $b849 ;f1=f1+0.5
=$ba2b			ff1xf2   = $ba2b ;f1=f1*f2
=$ba28			ff1xfv   = $ba28 ;f1=f1*fv ($yyaa)
=$bae2			ff1x10   = $bae2 ;f1=f1*10
=$bb12			ff2df1   = $bb12 ;f1=f2/f1
=$bb0f			ffvdf1   = $bb0f ;f1=fv/f1 ($yyaa)
=$bafe			ff1d10   = $bafe ;f1=f1/10
=$bc1b			ff1rnd   = $bc1b ;f1=round(f1)
=$bf7b			ff1ef2   = $bf7b ;f1=fac1^f2
=$bf71			ff1sqr   = $bf71 ;f1=sqrt(f1)
=$afe9			ffpand   = $afe9 ;f1=f1 and f2
=$afe6			ffpor    = $afe6 ;f1=f1 or f2
=$bccc			ff1int   = $bccc ;f1=int(f1)
=$b947			ff1com2  = $b947 ;f1=two's compl f1
=$bc39			ff1sign  = $bc39 ;f1=sgn(f1)
=$bc58			ff1abs   = $bc58 ;f1=abs(f1)
=$bc5b			ffvcmp   = $bc5b ;f1=f1 comp fv ($yyaa)
=$bc44			fi62tf1  = $bc44 ;ãonv f1 word 62,63
=$bc3c			fiaatf1  = $bc3c ;ãonv ácc to æð in f1
=$bdcd			fiaxtf1  = $bdcd ;f1=float($aaxx)+print
=$b3a2			fiyytf1  = $b3a2 ;f1=float(y)
=$bcf3			fasctf1  = $bcf3 ;f1=float(ascii)
=$bddd			ff1tasc  = $bddd ;f1 to ascii ($yyaa)
=$bc9b			ff1tudw  = $bc9b ;f1=unsighed dw(f1)
=$b1bf			ff1swd64 = $b1bf ;f1=sw(f1)->64
=$b1d2			ff1wrd64 = $b1d2 ;f1=uw(f1)->64
=$b1aa			ff1wrday = $b1aa ;f1=word->$aayy
=$b7a1			ff1bytxx = $b7a1 ;f1 to byte in x
=$b79e			ff1evalx = $b79e ;eval. expr. f1 to x
=$e264			ff1cos   = $e264 ;f1=sin(f1+(pi/2))
=$e26b			ff1sin   = $e26b ;f1=sin(f1)
=$e2b4			ff1tan   = $e2b4 ;f1=sin(f1)/cos(f1)
=$e30e			ff1atn   = $e30e ;f1=atn(f1)
=$bc2b			fsngf1   = $bc2b ;check f1 sign

;******  Return to file: prog.asm


;******  Processing file: e-64map.asm

=$73			chrget   = $73   ;Recup Basic car texte
=$79			chrgot   = $79   ; ...une seconde fois.
=$fb			zp1      = $fb   ;1er Zpage prog. usager
=$fd			zp2      = $fd   ;2em Zpage prog. usager
=$0100			fascii   = $0100 ;region conv FP a ascii
=$0286			kcol     = $0286 ;Couleur car affiche.
=$e3bf			intcgt   = $e3bf ;Initialize chrget
=$ffa5			acptr    = $ffa5 ;Recoit byte port serie
=$ffc6			chkin    = $ffc6 ;Definie canal entree
=$ffc9			chkout   = $ffc9 ;Definie canal sortie
=$ffcf			chrin    = $ffcf ;Entre car canal entree
=$ffd2			chrout   = $ffd2 ;Sort car canal sortie
=$ff81			cint     = $ff81 ;Init ecran edit+vicii
=$ffa8			ciout    = $ffa8 ;Sort car sur bus serie
=$ffe7			clall    = $ffe7 ;Ferme tout fichier ouv
=$ffc3			close    = $ffc3 ;Ferme fichier logique
=$ffcc			clrchn   = $ffcc ;Efface caneaux i/o
=$ffe4			getin    = $ffe4 ;Entre un car de entree
=$fff3			iobase   = $fff3 ;Definie page mem. i/o
=$ff84			ioinit   = $ff84 ;Init. Periph. i/o
=$ffb1			listen   = $ffb1 ;Cmd LISTEN a perip bus
=$ffd5			load     = $ffd5 ;Charge periph. en ram
=$ff9c			membot   = $ff9c ;Lec./Ecr. bas mem.
=$ff99			memtop   = $ff99 ;Lec./Ecr. haut mem.
=$ffc0			open     = $ffc0 ;Ouvre fichier logique.
=$fff0			plot     = $fff0 ;Lec./Ecr. pos. curseur
=$ff87			ramtas   = $ff87 ;Init ram tapebuf+ecran
=$ffde			rdtim    = $ffde ;Recup horloge systeme
=$ffb7			readst   = $ffb7 ;Recup mot status i/o
=$ff8a			restor   = $ff8a ;Replace vecteurs i/o
=$ffd8			save     = $ffd8 ;Sauve mem vers periph
=$ff9f			scnkey   = $ff9f ;Sonde le clavier
=$ffed			screen   = $ffed ;Recup format ecran
=$ff93			second   = $ff93 ;Trans adr secnd/listen
=$ffba			setlfs   = $ffba ;Prep. fichier logique
=$ff90			setmsg   = $ff90 ;Prep. kmesg outpt flag
=$ffbd			setnam   = $ffbd ;Prep. nom de fichier
=$ffdb			settim   = $ffdb ;Init. horloge systeme
=$ffa2			settmo   = $ffa2 ;Place ieee delai fin
=$ffe1			stop     = $ffe1 ;Verif. clef stop
=$ffb4			talk     = $ffb4 ;Cmd LISTEN periph/SB
=$ff96			tsks     = $ff96 ;Trans. TALK secnd adr
=$ffea			udtim    = $ffea ;Maj. horloge systeme
=$ffae			unlsn    = $ffae ;Trans. UNLISTEN
=$ffab			untlk    = $ffab ;Trans. UNTALK
=$ffd8			vector   = $ffd8 ;Lec/ecr vecteurs i/o
=$e1d4			setprms = $e1d4 ; Set param. load/save
=$ed09			stalk   = $ed09 ; serbus Snd Talk
=$ed0c			slisten = $ed0c ; serbus snd LISTEN
=$ed40			sflush  = $ed40 ; Flush serbus $0095
=$edb9			slisten2= $edb9 ; Snd LISTEN scnd. addr.
=$edb9			stalk2  = $edb9 ; Snd TALK scnd. addr.
=$eddd			sbout   = $eddd ; serbus Write byte
=$edef			sutalk  = $edef ; Snd UNTalk to serbus.
=$edfe			sulisten= $edfe ; Snd UNLSTN to serbus
=$ee85			sclkhigh= $ee85 ; Set CLOCK OUT to High
=$ee8e			clklow  = $ee8e ; Set CLOCK OUT to low
=$ee97			sdathigh= $ee97 ; Set DATA OUT to High
=$eea0			sdatlow = $eea0 ; Set DATA OUT to low
=$eea9			sclkdta = $eea9 ; Read CLOCK IN/DATA IN.
=$f1ad			sbread  = $f1ad ; Read byte from serport
=$f237			sstdin  = $F237 ; def. serbus std input
=$f279			sstdout = $F279 ; def. serbus std output
=$f3d5			sfopen  = $F3D5 ; Open file on serbus
=$f528			sutclose= $F528 ; snd UNTLK/CLOSE serbus
=$f63f			sulclose= $F63F ; snd UNLSTN+CLOSE serbu
=$f642			sfclose = $F642 ; Close file on serbus
=$fe21			stimeout= $FE21 ; (Set serbus timeout.)
=$e39a			k_echostartup  =    $e39a
=$e716			k_putch        =    $e716
=$e7a0			k_cls          =    $e7a0
=$e87c			k_cursordown   =    $e87c
=$e8ea			k_scrollup     =    $e8ea
=$e94e			k_home         =    $e94e
=$e965			k_insertline   =    $e965
=$e9c8			k_screlldown   =    $e9c8
=$ed0c			k_devsndlstn   =    $ed0c
=$ee13			k_ieeein       =    $ee13
=$eef6			k_devsndutalk  =    $eef6
=$ef04			k_devsndulstn  =    $ef04
=$f12f			k_putsysmsg    =    $f12f
=$f291			k_cloself      =    $f291
=$f49e			k_loadsub      =    $f49e
=$f5af			k_prnsrch      =    $f5af
=$f5b3			k_echosearch   =    $f5b3
=$f5c1			k_prnfnam      =    $f5c1
=$f6ed			k_stop         =    $f6ed
=$f7ea			k_gettaphdblk  =    $f7ea
=$f7ea			k_fndtaphdblk  =    $f7ea
=$f817			k_waittapplay  =    $f817
=$f841			k_rdtape2buff  =    $f841
=$f847			k_readtape     =    $f847
=$f864			k_wrbuff2tape  =    $f864
=$f869			k_wrtape       =    $f869
=$fb8e			k_resettapeio  =    $fb8e
=$fcbd			k_setintvect   =    $fcbd
=$fce2			k_coldreset    =    $fce2
=$fce2			k_coldstart    =    $fce2
=$fce2			k_coldboot     =    $fce2
=$fe66			k_warmreset    =    $fe66
=$fe66			k_warmboot     =    $fe66
=$fe66			k_warmstart    =    $fe66
=$ff93			k_devsndaddr2  =    $ff93
=$d000			vic      = $d000 ;debut du vic-ii
=$0340			sprtmem  = $0340 ;832
=$07f8			sprtloc  = $07f8 ;2040
=$2000			vidstart = $2000
=$3f3f			vidend   = $3f3f
=$0400			bakmem   = $0400 ;1024 end at $0800
=$abf9			prompt   = $abf9 ;prompt ? dans tampon.
=$ab24			strout   = $ab24 ;print string at $0022
=8			discase  = 8
=9			enacase  = 9
=14			locase   = 14
=142			upcase   = 142
=17			crsdown  = 17
=29			crsright = 29
=145			crsup    = 145
=157			crsleft  = 157
=18			enarevs  = 18
=146			disrevs  = 146
=19			gohome   = 19
=147			clrhome  = 147
=20			delete   = 20
=32			space    = 32
=144			knoir    = 144
=129			korange  = 129
=5			kblanc   = 5
=28			krouge   = 28
=30			kvert    = 30
=31			kbleu    = 31
=149			kbrun    = 149
=150			krose    = 150
=151			kgris1   = 151
=152			kgris2   = 152
=153			kvertp   = 153
=154			kbleup   = 154
=155			kgris3   = 155
=156			kmauve   = 156
=158			kjaune   = 158
=159			kcyan    = 159

;******  Return to file: prog.asm


;******  Processing file: m-utils.asm


;******  Return to file: prog.asm


;******  Processing file: l-bashead.asm

.0801			start
>0801	0b 08		bcmd1    .word $080b ;adresse de la pro-
>0803	0a 00		         .word $0a   ;no. ligne basic.
>0805	9e		         .byte $9e   ;jeton pour la
>0806	32 30 36 31	         .text "2061";adresse du debut
>080a	00		         .byte $00   ;fin de cmd basic.
>080b	00 00		bcmd2    .word $00   ;adresse de la pro-
.080d	20 14 08	         jsr initscr
.0810	20 2d 08	         jsr main
.0813	60		         rts
.0814			initscr
.0814	08		         php
.0815	48		         pha
.0816	a9 05		bord     lda #$05    ;place la couleur
.0818	8d 20 d0	         sta $d020   ; de la bordure.
.081b	a9 06		back     lda #$06    ;place la couleur
.081d	8d 21 d0	         sta $d021   ; du fond d'ecran.
.0820	a9 01		text     lda #$01    ;place la couleur
.0822	8d 86 02	         sta $0286   ; du texte.
.0825	a9 93		         lda #$93    ;efface l'ecran par
.0827	20 d2 ff	         jsr chrout  ; chrout du kernal.
.082a	68		         pla
.082b	28		         plp
.082c	60		         rts

;******  Return to file: prog.asm

.082d			main
.082d	20 e8 0b	         jsr anykey
.0830	a2 00		         ldx #0
.0832	a0 0a		         ldy #10
.0834	20 3b 0b	         jsr gotoxy
.0837	a2 c8		         ldx #200
.0839	a0 96		         ldy #150
.083b	20 16 09	         jsr calcdot
.083e	ad 5e 09	         lda col
.0841	20 a3 08	         jsr putahexdec
.0844	20 e8 0b	         jsr anykey
.0847	08		         php
.0848	48		         pha
.0849	a9 0d		         lda #$0d
.084b	20 d2 ff	         jsr chrout
.084e	68		         pla
.084f	28		         plp
.0850	ad 5d 09	         lda row
.0853	20 a3 08	         jsr putahexdec
.0856	20 e8 0b	         jsr anykey
.0859	08		         php
.085a	48		         pha
.085b	a9 0d		         lda #$0d
.085d	20 d2 ff	         jsr chrout
.0860	68		         pla
.0861	28		         plp
.0862	ad 5f 09	         lda lin
.0865	20 a3 08	         jsr putahexdec
.0868	20 e8 0b	         jsr anykey
.086b	08		         php
.086c	48		         pha
.086d	a9 0d		         lda #$0d
.086f	20 d2 ff	         jsr chrout
.0872	68		         pla
.0873	28		         plp
.0874	ad 60 09	         lda sbit
.0877	20 a3 08	         jsr putahexdec
.087a	20 e8 0b	         jsr anykey
.087d	08		         php
.087e	48		         pha
.087f	a9 0d		         lda #$0d
.0881	20 d2 ff	         jsr chrout
.0884	68		         pla
.0885	28		         plp
.0886	20 40 09	         jsr floattest
.0889	20 e8 0b	         jsr anykey
.088c	08		         php
.088d	48		         pha
.088e	a9 0d		         lda #$0d
.0890	20 d2 ff	         jsr chrout
.0893	68		         pla
.0894	28		         plp
.0895	60		         rts
>0896	48 45 4c 4c	chaine .null "hello world!"
>089a	4f 20 57 4f 52 4c 44 21 00
.08a3			putahexdec
.08a3	20 d5 09	         jsr pushregs
.08a6	48		         pha
.08a7	a9 9e		         lda #kjaune
.08a9	20 d2 ff	         jsr chrout
.08ac	68		         pla
.08ad	20 7f 0a	         jsr putahex
.08b0	aa		         tax
.08b1	a9 20		         lda #$20
.08b3	20 d2 ff	         jsr chrout
.08b6	a9 00		         lda #$00
.08b8	20 cd bd	         jsr fiaxtf1
.08bb	20 04 0a	         jsr popregs
.08be	60		         rts
.08bf			bmapinit
.08bf	08		         php
.08c0	48		         pha
.08c1	ad 18 d0	         lda vic+$18
.08c4	09 08		         ora #$08
.08c6	8d 18 d0	         sta vic+$18
.08c9	ad 11 d0	         lda vic+$11
.08cc	09 20		         ora #$20
.08ce	8d 11 d0	         sta vic+$11
.08d1	68		         pla
.08d2	28		         plp
.08d3	60		         rts
.08d4			bmapclr
.08d4	20 67 09	         jsr pushall
.08d7	a9 00		         lda #<vidstart
.08d9	85 fb		         sta zp1
.08db	a9 20		         lda #>vidstart
.08dd	85 fc		         sta zp1+1
.08df	a0 00		         ldy #$00
.08e1	a9 00		more     lda #$00
.08e3	91 fb		         sta (zp1),y
.08e5	20 2b 0a	         jsr inczp1
.08e8	a5 fc		         lda zp1+1
.08ea	c9 3f		         cmp #$3f
.08ec	d0 f3		         bne more
.08ee	a5 fb		         lda zp1
.08f0	c9 3f		         cmp #$3f
.08f2	d0 ed		         bne more
.08f4	20 a2 09	         jsr popall
.08f7	60		         rts
.08f8			bmpfillbk
.08f8	20 67 09	         jsr pushall
.08fb	a9 00		         lda #<bakmem
.08fd	85 fb		         sta zp1
.08ff	a9 04		         lda #>bakmem
.0901	85 fc		         sta zp1+1
.0903	a2 08		         ldx #$08
.0905	a0 00		         ldy #$00
.0907	a9 01		         lda #$01
.0909	91 fb		more     sta (zp1),y
.090b	20 2b 0a	         jsr inczp1
.090e	e4 fc		         cpx zp1+1
.0910	d0 f7		         bne more
.0912	20 a2 09	         jsr popall
.0915	60		         rts
.0916			calcdot
.0916	20 67 09	         jsr pushall
.0919	98		         tya     ;y contien la ligne
.091a	4a		         lsr a   ; on divise par 8
.091b	4a		         lsr a
.091c	4a		         lsr a
.091d	8d 5d 09	         sta row ; et on sauvegarde
.0920	8a		         txa     ;x contien la colonne
.0921	4a		         lsr a   ; on divise par 8
.0922	4a		         lsr a
.0923	4a		         lsr a
.0924	8d 5e 09	         sta col ; et on sauvegarde
.0927	98		         tya     ; masque avec 7 donne
.0928	29 07		         and #$07; la ligne caractere
.092a	8d 5f 09	         sta lin ; du pixel.
.092d	8a		         txa     ;7-(x and 7) donne le
.092e	29 07		         and #$07; no du bit de l'octet
.0930	8d 60 09	         sta sbit; du pixel.
.0933	a9 07		         lda #$07
.0935	38		         sec
.0936	ed 60 09	         sbc sbit
.0939	8d 60 09	         sta sbit
.093c	20 a2 09	         jsr popall
.093f	60		         rts
.0940			floattest
.0940	08		         php
.0941	48		         pha
.0942	a9 07		         lda #$07
.0944	8d 86 02	         sta kcol
.0947	ac 60 09	         ldy sbit
.094a	20 a2 b3	         jsr fiyytf1
.094d	a9 03		         lda #$03
.094f	8d 86 02	         sta kcol
.0952	20 8e 0b	         jsr prnfac1
.0955	a9 01		         lda #$01
.0957	8d 86 02	         sta kcol
.095a	68		         pla
.095b	28		         plp
.095c	60		         rts
>095d	00		row      .byte $00
>095e	00		col      .byte $00
>095f	00		lin      .byte $00
>0960	55		sbit     .byte $55
>0961	00 00		adrs     .word $00
>0963	00 20		baseaddr .word $2000 ;8192
>0965	40 01		scrwidth .word $0140 ;320

;******  Processing file: l-push.asm

.0967			pushall
.0967	08		         php     ;s;p,pcl,pch
.0968	78		         sei
.0969	8d a8 02	         sta ra  ;save a
.096c	68		         pla     ;s:pcl,pch
.096d	8d a7 02	         sta rp  ;save rp
.0970	68		         pla     ;s:pch
.0971	8d a9 02	         sta pc  ;save pcl
.0974	68		         pla     ;s:
.0975	8d aa 02	         sta pc+1;save pch
.0978	a5 fb		         lda $fb ;save fb
.097a	48		         pha     ;s:fb
.097b	a5 fc		         lda $fc ;save fc
.097d	48		         pha     ;s:fc,fb
.097e	a5 fd		         lda $fd ;save fd
.0980	48		         pha     ;s:fd,fc,fb
.0981	a5 fe		         lda $fe ;save fe
.0983	48		         pha     ;s:fe,fd,fc,fb
.0984	ad a7 02	         lda rp  ;save rp
.0987	48		         pha     ;s:rp,fe,fd,fc,fb
.0988	ad a8 02	         lda ra  ;save ra
.098b	48		         pha     ;s:ra,rp,fe,fd,fc,fb
.098c	8a		         txa     ;save rx
.098d	48		         pha     ;s:rx,ra,rp,fe-fb
.098e	98		         tya     ;save y
.098f	48		         pha     ;s:ry,rx,ra,rp,fe-fb
.0990	ad aa 02	         lda pc+1;replace l'adresse
.0993	48		         pha     ;s:pch,ry,rx,ra,...
.0994	ad a9 02	         lda pc  ; de retour.
.0997	48		         pha     ;s:pcl,pch,ru,rx,ra,...
.0998	ad a7 02	         lda rp  ;place les flags
.099b	48		         pha     ; sur le stack.
.099c	ad a8 02	         lda ra  ;recupere ra
.099f	28		         plp     ;recupere les flags.
.09a0	58		         cli
.09a1	60		         rts
.09a2			popall
.09a2	78		         sei     ;s:pcl,pch,ry,rx,...
.09a3	68		         pla     ;s:pch,ry,rx,ra,rp,...
.09a4	8d a9 02	         sta pc  ;sauve pcl
.09a7	68		         pla     ;s:ry,rx,ra,rp,fe...fb
.09a8	8d aa 02	         sta pc+1;sauve pch
.09ab	68		         pla     ;s:rx,ra,rp,fe,fd,fc,fb
.09ac	a8		         tay     ;recupere ry
.09ad	68		         pla     ;s:ra,rp,fe,fd,fc,fb
.09ae	aa		         tax     ;recupere rx
.09af	68		         pla     ;s:rp,fe,fd,fc,fb
.09b0	8d a8 02	         sta ra  ;recupere ra
.09b3	68		         pla     ;s:fe,fd,fc,fb
.09b4	8d a7 02	         sta rp  ;recupere les flags.
.09b7	68		         pla     ;s:fd,fc,fb
.09b8	85 fe		         sta $fe ;reccupere fe
.09ba	68		         pla     ;s:fc,fb
.09bb	85 fd		         sta $fd ;recupere fd
.09bd	68		         pla     ;s:fb
.09be	85 fc		         sta $fc ;recupere fc
.09c0	68		         pla     ;s:
.09c1	85 fb		         sta $fb ;recupere fb
.09c3	ad aa 02	         lda pc+1;replaace l'adresse de
.09c6	48		         pha     ;s:pch
.09c7	ad a9 02	         lda pc  ;retour sur la pile
.09ca	48		         pha     ;s:pcl,pch
.09cb	ad a7 02	         lda rp  ;recupere les flags
.09ce	48		         pha     ;s:rp,pcl,pch
.09cf	ad a8 02	         lda ra  ;recupere ra
.09d2	58		         cli     ;
.09d3	28		         plp     ;s:pcl,pch
.09d4	60		         rts
.09d5			pushregs
.09d5	08		         php     ;s;p,pcl,pch
.09d6	78		         sei
.09d7	8d a8 02	         sta ra  ;save a
.09da	68		         pla     ;s:pcl,pch
.09db	8d a7 02	         sta rp  ;save rp
.09de	68		         pla     ;s:pch
.09df	8d a9 02	         sta pc  ;save pcl
.09e2	68		         pla     ;s:
.09e3	8d aa 02	         sta pc+1;save pch
.09e6	ad a7 02	         lda rp  ;save rp
.09e9	48		         pha     ;s:rp
.09ea	ad a8 02	         lda ra  ;save ra
.09ed	48		         pha     ;s:ra,rp
.09ee	8a		         txa     ;save rx
.09ef	48		         pha     ;s:rx,ra,rp
.09f0	98		         tya     ;save y
.09f1	48		         pha     ;s:ry,rx,ra,rp
.09f2	ad aa 02	         lda pc+1;replace l'adresse
.09f5	48		         pha     ;s:pch,ry,rx,ra,rp
.09f6	ad a9 02	         lda pc  ; de retour.
.09f9	48		         pha     ;s:pcl,pch,ru,rx,ra,rp
.09fa	ad a7 02	         lda rp  ;place les flags
.09fd	48		         pha     ; sur le stack.
.09fe	ad a8 02	         lda ra  ;recupere ra
.0a01	28		         plp     ;recupere les flags.
.0a02	58		         cli
.0a03	60		         rts
.0a04			popregs
.0a04	78		         sei     ;s:pcl,pch,ry,rx,ra,rp
.0a05	68		         pla     ;s:pch,ry,rx,ra,rp
.0a06	8d a9 02	         sta pc  ;sauve pcl
.0a09	68		         pla     ;s:ry,rx,ra,rp
.0a0a	8d aa 02	         sta pc+1;sauve pch
.0a0d	68		         pla     ;s:rx,ra,rp
.0a0e	a8		         tay     ;recupere ry
.0a0f	68		         pla     ;s:ra,rp
.0a10	aa		         tax     ;recupere rx
.0a11	68		         pla     ;s:rp
.0a12	8d a8 02	         sta ra  ;recupere ra
.0a15	68		         pla     ;s:
.0a16	8d a7 02	         sta rp  ;recupere les flags.
.0a19	ad aa 02	         lda pc+1;replaace l'adresse de
.0a1c	48		         pha     ;s:pch
.0a1d	ad a9 02	         lda pc  ;retour sur la pile
.0a20	48		         pha     ;s:pcl,pch
.0a21	ad a7 02	         lda rp  ;recupere les flags
.0a24	48		         pha     ;s:rp,pcl,pch
.0a25	ad a8 02	         lda ra  ;recupere ra
.0a28	58		         cli     ;
.0a29	28		         plp     ;s:pcl,pch
.0a2a	60		         rts

;******  Return to file: prog.asm


;******  Processing file: l-mem.asm

.0a2b			inczp1
.0a2b	08		         php
.0a2c	e6 fb		         inc zp1
.0a2e	d0 02		         bne repzp1
.0a30	e6 fc		         inc zp1+1
.0a32	28		repzp1   plp
.0a33	60		         rts
.0a34			inczp2
.0a34	08		         php
.0a35	e6 fd		         inc zp2
.0a37	d0 02		         bne repzp2
.0a39	e6 fe		         inc zp2+1
.0a3b	28		repzp2   plp
.0a3c	60		         rts
.0a3d			deczp1
.0a3d	08		         php
.0a3e	48		         pha
.0a3f	c6 fb		         dec zp1
.0a41	a5 fb		         lda zp1
.0a43	c9 ff		         cmp #$ff
.0a45	d0 02		         bne pullzp1
.0a47	c6 fc		         dec zp1+1
.0a49	68		pullzp1  pla
.0a4a	28		         plp
.0a4b	60		         rts
.0a4c			deczp2
.0a4c	08		         php
.0a4d	48		         pha
.0a4e	c6 fd		         dec zp2
.0a50	a5 fd		         lda zp2
.0a52	c9 ff		         cmp #$ff
.0a54	d0 02		         bne pullzp2
.0a56	c6 fe		         dec zp2+1
.0a58	68		pullzp2  pla
.0a59	28		         plp
.0a5a	60		         rts

;******  Return to file: prog.asm


;******  Processing file: l-conv.asm

.0a5b			putyxhex
.0a5b	20 67 09	         jsr pushall
.0a5e	98		         tya
.0a5f	48		         pha
.0a60	20 b4 0a	         jsr lsr4bits
.0a63	20 bb 0a	         jsr nibtohex
.0a66	8d cb 0a	         sta hexstr+0
.0a69	68		         pla
.0a6a	20 bb 0a	         jsr nibtohex
.0a6d	8d cc 0a	         sta hexstr+1
.0a70	8a		         txa
.0a71	20 99 0a	         jsr atohex
.0a74	a2 cb		         ldx #<hexstr+0
.0a76	a0 0a		         ldy #>hexstr+0
.0a78	20 fb 0a	         jsr putsyx
.0a7b	20 a2 09	         jsr popall
.0a7e	60		         rts
.0a7f			putahex
.0a7f	08		         php
.0a80	48		         pha
.0a81	8d 98 0a	         sta thisra
.0a84	98		         tya
.0a85	48		         pha
.0a86	ad 98 0a	         lda thisra
.0a89	20 99 0a	         jsr atohex
.0a8c	a2 cd		         ldx #<hexstr+2
.0a8e	a0 0a		         ldy #>hexstr+2
.0a90	20 fb 0a	         jsr putsyx
.0a93	68		         pla
.0a94	a8		         tay
.0a95	68		         pla
.0a96	28		         plp
.0a97	60		         rts
>0a98	00		thisra   .byte $00
.0a99			atohex
.0a99	08		         php
.0a9a	48		         pha
.0a9b	48		         pha
.0a9c	20 b4 0a	         jsr lsr4bits
.0a9f	20 bb 0a	         jsr nibtohex
.0aa2	8d cd 0a	         sta hexstr+2
.0aa5	68		         pla
.0aa6	20 bb 0a	         jsr nibtohex
.0aa9	8d ce 0a	         sta hexstr+3
.0aac	a9 00		         lda #$00
.0aae	8d cf 0a	         sta hexstr+4
.0ab1	68		         pla
.0ab2	28		         plp
.0ab3	60		         rts
.0ab4			lsr4bits
.0ab4	08		         php
.0ab5	4a		         lsr a
.0ab6	4a		         lsr a
.0ab7	4a		         lsr a
.0ab8	4a		         lsr a
.0ab9	28		         plp
.0aba	60		         rts
.0abb			nibtohex
.0abb	08		         php
.0abc	29 0f		         and #$0f
.0abe	f8		         sed
.0abf	18		         clc
.0ac0	69 90		         adc #$90
.0ac2	69 40		         adc #$40
.0ac4	d8		         cld
.0ac5	28		         plp
.0ac6	60		         rts
>0ac7	01		a2hexcol .byte $01
.0ac8			a2hexpos
>0ac8	01		a2hexpx  .byte $01
>0ac9	01		a2hexpy  .byte $01
>0aca	24		a2hexpfx .byte 36
>0acb	00 00 00 00	hexstr   .byte $00,$00,$00,$00,$00
>0acf	00
>0ad0	01		a2bincol .byte $01
.0ad1			a2binpos
>0ad1	01		a2binpx  .byte $01
>0ad2	01		a2binpy  .byte $01
>0ad3	25		a2binpfx .byte 37
>0ad4	30 30 30 30	binstr   .null "00000000"
>0ad8	30 30 30 30 00
>0add	01		a2deccol .byte $01
.0ade			a2decpos
>0ade	01		a2decpx  .byte $01
>0adf	01		a2decpy  .byte $01
>0ae0	25		a2decpfx .byte 37
>0ae1	30 30 30 30	decstr   .null "00000"
>0ae5	30 00

;******  Return to file: prog.asm


;******  Processing file: l-string.asm

.0ae7			puts
.0ae7	20 67 09	         jsr pushall
.0aea	a0 00		         ldy #$00   ; y = offset
.0aec	b1 fb		nextc    lda ($fb),y;lit un caractere
.0aee	f0 07		         beq out    ;si 0 on sort
.0af0	20 d2 ff	         jsr chrout ;on l'affiche
.0af3	c8		         iny        ;pointe le prochain
.0af4	4c ec 0a	         jmp nextc  ; et l'affiche
.0af7	20 a2 09	out      jsr popall
.0afa	60		         rts
.0afb			putsyx
.0afb	20 67 09	         jsr pushall;sauve reg + zps
.0afe	86 fb		         stx $fb    ;$yyxx dans
.0b00	84 fc		         sty $fb+1  ; zp1
.0b02	20 e7 0a	         jsr puts
.0b05	20 a2 09	         jsr popall ;recup reg + zps
.0b08	60		         rts
.0b09			putsc
.0b09	08		         php        ;flag sur stack
.0b0a	48		         pha        ;acc sur stack
.0b0b	48		         pha        ;sauvegarde acc
.0b0c	ad 86 02	         lda kcol   ;recup coul. carac.
.0b0f	8d ab 02	         sta curcol ; et la sauvegarde
.0b12	68		         pla        ;recup. acc
.0b13	8d 86 02	         sta kcol   ;place coul. voulue
.0b16	20 e7 0a	         jsr puts   ;affiche la chaine
.0b19	ad ab 02	         lda curcol ;recup coul. carac.
.0b1c	8d 86 02	         sta kcol   ; et la replace
.0b1f	68		         pla        ;recup acc
.0b20	28		         plp        ;recup flag
.0b21	60		         rts
.0b22			putxcxy
.0b22	08		         php       ;sauve registres
.0b23	48		         pha       ; ...
.0b24	48		         pha       ;sauve acc
.0b25	ad 86 02	         lda kcol  ;recup couleur carac.
.0b28	8d ab 02	         sta curcol; et sauvegarde
.0b2b	68		         pla       ;recup acc
.0b2c	8d 86 02	         sta kcol  ;place couleur carac.
.0b2f	20 fb 0a	         jsr putsyx;affiche la chaine
.0b32	ad ab 02	         lda curcol
.0b35	8d 86 02	         sta kcol
.0b38	68		         pla
.0b39	28		         plp
.0b3a	60		         rts
.0b3b			gotoxy
.0b3b	20 d5 09	        jsr pushregs
.0b3e	8a		        txa
.0b3f	48		        pha
.0b40	98		        tya
.0b41	aa		        tax
.0b42	68		        pla
.0b43	a8		        tay
.0b44	c0 00		txlow   cpy #0
.0b46	10 02		        bpl txhigh
.0b48	a2 00		        ldx #0
.0b4a	e0 28		txhigh  cpx #40
.0b4c	30 02		        bmi tylow
.0b4e	a2 27		        ldx #39
.0b50	c0 00		tylow   cpy #0
.0b52	10 02		        bpl tyhigh
.0b54	a0 00		        ldy #0
.0b56	c0 19		tyhigh  cpy #25
.0b58	30 02		        bmi allok
.0b5a	a0 18		        ldy #24
.0b5c	18		allok   clc
.0b5d	20 f0 ff	        jsr plot
.0b60	20 04 0a	        jsr popregs
.0b63	60		        rts

;******  Return to file: prog.asm


;******  Processing file: l-float.asm

.0b64			clrbasbuf
.0b64	08		         php
.0b65	48		         pha
.0b66	98		         tya
.0b67	48		         pha
.0b68	a9 00		         lda #$00
.0b6a	a0 59		         ldy #$59
.0b6c	99 00 02	again    sta $0200,y
.0b6f	88		         dey
.0b70	d0 fa		         bne again
.0b72	68		         pla
.0b73	a8		         tay
.0b74	68		         pla
.0b75	28		         plp
.0b76	60		         rts
.0b77			getfac1
.0b77	20 d5 09	         jsr pushregs
.0b7a	20 64 0b	         jsr clrbasbuf
.0b7d	20 f9 ab	         jsr prompt
.0b80	86 7a		         stx $7a
.0b82	84 7b		         sty $7b
.0b84	20 73 00	         jsr chrget
.0b87	20 f3 bc	         jsr fasctf1 ;conv. ascii->float
.0b8a	20 04 0a	         jsr popregs
.0b8d	60		         rts
.0b8e			prnfac1
.0b8e	20 d5 09	         jsr pushregs
.0b91	20 dd bd	         jsr ff1tasc
.0b94	a0 01		         ldy #>fascii
.0b96	a2 00		         ldx #<fascii
.0b98	20 fb 0a	         jsr putsyx
.0b9b	20 04 0a	         jsr popregs
.0b9e	60		         rts
>0b9f	00 00 00 00	fvar1    .word $00,$00,$00
>0ba3	00 00
>0ba5	00 00 00 00	fvar2    .word $00,$00,$00
>0ba9	00 00
>0bab	20 20 20 20	float1   .null "                 "
>0baf	20 20 20 20 20 20 20 20 20 20 20 20 20 00
>0bbd	20 20 20 20	float2   .null "                 "
>0bc1	20 20 20 20 20 20 20 20 20 20 20 20 20 00
>0bcf	55		tval1    .byte $55
>0bd0	40 01		tval2    .word 320

;******  Return to file: prog.asm


;******  Processing file: l-keyb.asm

.0bd2			clrkbbuf
.0bd2	08		            php
.0bd3	48		            pha
.0bd4	a9 00		            lda #0
.0bd6	85 c6		            sta 198
.0bd8	68		            pla
.0bd9	28		            plp
.0bda	60		            rts
.0bdb			waitstop
.0bdb	08		          php    ;\ sauve les flags
.0bdc	48		          pha    ;/  et l'acc.
.0bdd	20 d2 0b	          jsr clrkbbuf
.0be0	20 ed f6	wait      jsr k_stop  ; Veri [run/stop]
.0be3	d0 fb		          bne  wait   ;loop pas pesee.
.0be5	68		          pla    ;\ recup. acc et
.0be6	28		          plp    ;/  les flags.
.0be7	60		          rts
.0be8			anykey
.0be8	08		            php     ;\ sauve les flags
.0be9	48		            pha     ;/  et l'acc.
.0bea	20 d2 0b	            jsr clrkbbuf
.0bed	a5 cb		wait        lda 203 ;lit la matrice de
.0bef	c9 40		            cmp #64 ; si 64 alors aucune
.0bf1	f0 fa		            beq wait; on attend qu'il y
.0bf3	20 fc 0b	            jsr kbfree ; on attend que
.0bf6	20 d2 0b	            jsr clrkbbuf
.0bf9	68		            pla     ;\ recup. l'acc et
.0bfa	28		            plp     ;/  les flags.
.0bfb	60		            rts
.0bfc			kbfree
.0bfc	08		            php     ;\ sauve les flags
.0bfd	48		            pha     ;/  et l'acc.
.0bfe	a5 cb		wait        lda 203 ;lit la matrice de
.0c00	c9 40		            cmp #64 ; si 64 alors aucune
.0c02	d0 fa		            bne wait;on attend qu'il y
.0c04	68		            pla     ;\ recup. l'acc et
.0c05	28		            plp     ;/  les flags.
.0c06	60		            rts
.0c07			getkey
.0c07	08		            php     ; sauve les flags.
.0c08	20 e4 ff	try         jsr getin ;tente de lire
.0c0b	c9 00		            cmp #0  ; 0 si aucune.
.0c0d	f0 f9		            beq try ; aucune, on attend.
.0c0f	28		            plp     ; recup. les flags.
.0c10	60		            rts
.0c11			waitkey
.0c11	08		            php      ;\ sauve les flags
.0c12	48		            pha      ;/  et l'acc.
.0c13	8d 2d 0c	            sta clef ; sauve cle voulue.
.0c16	20 d2 0b	            jsr clrkbbuf
.0c19	20 e4 ff	wait        jsr getin; tente lire clef.
.0c1c	cd 2d 0c	            cmp clef ;compare avec clef
.0c1f	d0 f8		            bne wait ;pas la bonne.
.0c21	68		            pla      ;\ recup. l'acc et
.0c22	28		            plp      ;/  les flags.
.0c23	60		            rts
.0c24			waitspace
.0c24	a9 20		            lda #$20
.0c26	20 11 0c	            jsr waitkey
.0c29	20 d2 0b	            jsr clrkbbuf
.0c2c	60		            rts
>0c2d	00		clef        .byte   0

;******  Return to file: prog.asm


;******  End of listing
