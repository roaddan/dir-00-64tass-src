
; 64tass Turbo Assembler Macro V1.54.1900 listing file
; 64tass -C -m -a -I /Users/Locals/C64/00-usbkey32go/d-00-64tass-src/lib -i -L prog.txt -o prog.prg prog.asm
; Wed Dec  3 09:17:55 2025

;Offset	;Hex		;Source

;******  Processing input file: prog.asm


;******  Processing file: e-vars.asm

=$02a7			rp       = $02a7 ; byte
=$02a8			ra       = $02a8 ; byte
=$02a9			pc       = $02a9 ; word
=$02ab			curcol   = $02ab ; coul. kernal sauvee
=$02ac			freevar  = $02ac ; non utilisee

;******  Return to file: prog.asm


;******  Processing file: e-float.asm

=$bba2			ffvtf1   = $bba2 ;copie fv $(yyxx) to f1
=$ba8c			ffvtf2   = $ba8c ;copie fv $(yyxx) to f2
=$bbd0			ff1t49   = $bbd0 ;copie f1 to $49.
=$bbd4			ff1tyx   = $bbd4 ;copie f1 to (yyxx).
=$bbc7			ff1t5c   = $bbc7 ;copie f1 to $5c-$60
=$bbca			ff1t57   = $bbca ;copie f1 to $57-$5b
=$bbfc			ff2tf1   = $bbfc ;copie f2 to f1
=$bc0c			ff1tf2   = $bc0c ;copie f1 to f2
=$b86a			ff2pf1   = $b86a ;f1=f2+f1
=$bd7e			ff1pac   = $bd7e ;f1=f1+ra=(0-9)
=$b867			ffvpf1   = $b867 ;f1=fv+f1 ($yyaa)
=$b853			ff2sf1   = $b853 ;f1=f2-f1
=$b850			ffvsf1   = $b850 ;f1=fv-f1 ($yyaa)
=$b849			ff1p05   = $b849 ;f1=f1+0.5
=$ba2b			ff1xf2   = $ba2b ;f1=f1*f2
=$ba28			ff1xfv   = $ba28 ;f1=f1*fv ($yyaa)
=$bae2			ff1x10   = $bae2 ;f1=f1*10
=$bb12			ff2df1   = $bb12 ;f1=f2/f1
=$bb0f			ffvdf1   = $bb0f ;f1=fv/f1 ($yyaa)
=$bafe			ff1d10   = $bafe ;f1=f1/10
=$bc1b			ff1rnd   = $bc1b ;f1=round(f1)
=$bf7b			ff1ef2   = $bf7b ;f1=fac1^f2
=$bf71			ff1sqr   = $bf71 ;f1=sqrt(f1)
=$afe9			ffpand   = $afe9 ;f1=f1 and f2
=$afe6			ffpor    = $afe6 ;f1=f1 or f2
=$bccc			ff1int   = $bccc ;f1=int(f1)
=$b947			ff1com2  = $b947 ;f1=two's compl f1
=$bc39			ff1sign  = $bc39 ;f1=sgn(f1)
=$bc58			ff1abs   = $bc58 ;f1=abs(f1)
=$bc5b			ffvcmp   = $bc5b ;f1=f1 comp fv ($yyaa)
=$bc44			fi62tf1  = $bc44 ;ãonv f1 word 62,63
=$bc3c			fiaatf1  = $bc3c ;ãonv ácc to æð in f1
=$bdcd			fiaxtf1  = $bdcd ;f1=float($aaxx)+print
=$b3a2			fiyytf1  = $b3a2 ;f1=float(y)
=$bcf3			fasctf1  = $bcf3 ;f1=float(ascii)
=$bddd			ff1tasc  = $bddd ;f1 to ascii ($yyaa)
=$bc9b			ff1tudw  = $bc9b ;f1=unsighed dw(f1)
=$b1bf			ff1swd64 = $b1bf ;f1=sw(f1)->64
=$b1d2			ff1wrd64 = $b1d2 ;f1=uw(f1)->64
=$b1aa			ff1wrday = $b1aa ;f1=word->$aayy
=$b7a1			ff1bytxx = $b7a1 ;f1 to byte in x
=$b79e			ff1evalx = $b79e ;eval. expr. f1 to x
=$e264			ff1cos   = $e264 ;f1=sin(f1+(pi/2))
=$e26b			ff1sin   = $e26b ;f1=sin(f1)
=$e2b4			ff1tan   = $e2b4 ;f1=sin(f1)/cos(f1)
=$e30e			ff1atn   = $e30e ;f1=atn(f1)
=$bc2b			fsngf1   = $bc2b ;check f1 sign

;******  Return to file: prog.asm


;******  Processing file: e-64map.asm

=$73			chrget   = $73   ;Recup Basic car texte
=$79			chrgot   = $79   ; ...une seconde fois.
=$fb			zp1      = $fb   ;1er Zpage prog. usager
=$fd			zp2      = $fd   ;2em Zpage prog. usager
=$0100			fascii   = $0100 ;region conv FP a ascii
=$0286			kcol     = $0286 ;Couleur car affiche.
=$e3bf			intcgt   = $e3bf ;Initialize chrget
=$ffa5			acptr    = $ffa5 ;Recoit byte port serie
=$ffc6			chkin    = $ffc6 ;Definie canal entree
=$ffc9			chkout   = $ffc9 ;Definie canal sortie
=$ffcf			chrin    = $ffcf ;Entre car canal entree
=$ffd2			chrout   = $ffd2 ;Sort car canal sortie
=$ff81			cint     = $ff81 ;Init ecran edit+vicii
=$ffa8			ciout    = $ffa8 ;Sort car sur bus serie
=$ffe7			clall    = $ffe7 ;Ferme tout fichier ouv
=$ffc3			close    = $ffc3 ;Ferme fichier logique
=$ffcc			clrchn   = $ffcc ;Efface caneaux i/o
=$ffe4			getin    = $ffe4 ;Entre un car de entree
=$fff3			iobase   = $fff3 ;Definie page mem. i/o
=$ff84			ioinit   = $ff84 ;Init. Periph. i/o
=$ffb1			listen   = $ffb1 ;Cmd LISTEN a perip bus
=$ffd5			load     = $ffd5 ;Charge periph. en ram
=$ff9c			membot   = $ff9c ;Lec./Ecr. bas mem.
=$ff99			memtop   = $ff99 ;Lec./Ecr. haut mem.
=$ffc0			open     = $ffc0 ;Ouvre fichier logique.
=$fff0			plot     = $fff0 ;Lec./Ecr. pos. curseur
=$ff87			ramtas   = $ff87 ;Init ram tapebuf+ecran
=$ffde			rdtim    = $ffde ;Recup horloge systeme
=$ffb7			readst   = $ffb7 ;Recup mot status i/o
=$ff8a			restor   = $ff8a ;Replace vecteurs i/o
=$ffd8			save     = $ffd8 ;Sauve mem vers periph
=$ff9f			scnkey   = $ff9f ;Sonde le clavier
=$ffed			screen   = $ffed ;Recup format ecran
=$ff93			second   = $ff93 ;Trans adr secnd/listen
=$ffba			setlfs   = $ffba ;Prep. fichier logique
=$ff90			setmsg   = $ff90 ;Prep. kmesg outpt flag
=$ffbd			setnam   = $ffbd ;Prep. nom de fichier
=$ffdb			settim   = $ffdb ;Init. horloge systeme
=$ffa2			settmo   = $ffa2 ;Place ieee delai fin
=$ffe1			stop     = $ffe1 ;Verif. clef stop
=$ffb4			talk     = $ffb4 ;Cmd LISTEN periph/SB
=$ff96			tsks     = $ff96 ;Trans. TALK secnd adr
=$ffea			udtim    = $ffea ;Maj. horloge systeme
=$ffae			unlsn    = $ffae ;Trans. UNLISTEN
=$ffab			untlk    = $ffab ;Trans. UNTALK
=$ffd8			vector   = $ffd8 ;Lec/ecr vecteurs i/o
=$e1d4			setprms = $e1d4 ; Set param. load/save
=$ed09			stalk   = $ed09 ; serbus Snd Talk
=$ed0c			slisten = $ed0c ; serbus snd LISTEN
=$ed40			sflush  = $ed40 ; Flush serbus $0095
=$edb9			slisten2= $edb9 ; Snd LISTEN scnd. addr.
=$edb9			stalk2  = $edb9 ; Snd TALK scnd. addr.
=$eddd			sbout   = $eddd ; serbus Write byte
=$edef			sutalk  = $edef ; Snd UNTalk to serbus.
=$edfe			sulisten= $edfe ; Snd UNLSTN to serbus
=$ee85			sclkhigh= $ee85 ; Set CLOCK OUT to High
=$ee8e			clklow  = $ee8e ; Set CLOCK OUT to low
=$ee97			sdathigh= $ee97 ; Set DATA OUT to High
=$eea0			sdatlow = $eea0 ; Set DATA OUT to low
=$eea9			sclkdta = $eea9 ; Read CLOCK IN/DATA IN.
=$f1ad			sbread  = $f1ad ; Read byte from serport
=$f237			sstdin  = $F237 ; def. serbus std input
=$f279			sstdout = $F279 ; def. serbus std output
=$f3d5			sfopen  = $F3D5 ; Open file on serbus
=$f528			sutclose= $F528 ; snd UNTLK/CLOSE serbus
=$f63f			sulclose= $F63F ; snd UNLSTN+CLOSE serbu
=$f642			sfclose = $F642 ; Close file on serbus
=$fe21			stimeout= $FE21 ; (Set serbus timeout.)
=$e39a			k_echostartup  =    $e39a
=$e716			k_putch        =    $e716
=$e7a0			k_cls          =    $e7a0
=$e87c			k_cursordown   =    $e87c
=$e8ea			k_scrollup     =    $e8ea
=$e94e			k_home         =    $e94e
=$e965			k_insertline   =    $e965
=$e9c8			k_screlldown   =    $e9c8
=$ed0c			k_devsndlstn   =    $ed0c
=$ee13			k_ieeein       =    $ee13
=$eef6			k_devsndutalk  =    $eef6
=$ef04			k_devsndulstn  =    $ef04
=$f12f			k_putsysmsg    =    $f12f
=$f291			k_cloself      =    $f291
=$f49e			k_loadsub      =    $f49e
=$f5af			k_prnsrch      =    $f5af
=$f5b3			k_echosearch   =    $f5b3
=$f5c1			k_prnfnam      =    $f5c1
=$f6ed			k_stop         =    $f6ed
=$f7ea			k_gettaphdblk  =    $f7ea
=$f7ea			k_fndtaphdblk  =    $f7ea
=$f817			k_waittapplay  =    $f817
=$f841			k_rdtape2buff  =    $f841
=$f847			k_readtape     =    $f847
=$f864			k_wrbuff2tape  =    $f864
=$f869			k_wrtape       =    $f869
=$fb8e			k_resettapeio  =    $fb8e
=$fcbd			k_setintvect   =    $fcbd
=$fce2			k_coldreset    =    $fce2
=$fce2			k_coldstart    =    $fce2
=$fce2			k_coldboot     =    $fce2
=$fe66			k_warmreset    =    $fe66
=$fe66			k_warmboot     =    $fe66
=$fe66			k_warmstart    =    $fe66
=$ff93			k_devsndaddr2  =    $ff93
=$d000			vic      = $d000 ;debut du vic-ii
=$0340			sprtmem  = $0340 ;832
=$07f8			sprtloc  = $07f8 ;2040
=$2000			vidstart = $2000
=$3f3f			vidend   = $3f3f
=$0400			bakmem   = $0400 ;1024 end at $0800
=$abf9			prompt   = $abf9 ;prompt ? dans tampon.
=$ab24			strout   = $ab24 ;print string at $0022
=8			discase  = 8
=9			enacase  = 9
=14			locase   = 14
=142			upcase   = 142
=17			crsdown  = 17
=29			crsright = 29
=145			crsup    = 145
=157			crsleft  = 157
=18			enarevs  = 18
=146			disrevs  = 146
=19			gohome   = 19
=147			clrhome  = 147
=20			delete   = 20
=32			space    = 32
=144			knoir    = 144
=129			korange  = 129
=5			kblanc   = 5
=28			krouge   = 28
=30			kvert    = 30
=31			kbleu    = 31
=149			kbrun    = 149
=150			krose    = 150
=151			kgris1   = 151
=152			kgris2   = 152
=153			kvertp   = 153
=154			kbleup   = 154
=155			kgris3   = 155
=156			kmauve   = 156
=158			kjaune   = 158
=159			kcyan    = 159

;******  Return to file: prog.asm


;******  Processing file: m-utils.asm


;******  Return to file: prog.asm


;******  Processing file: l-bashead.asm

.0801			start
>0801	0b 08		bcmd1    .word $080b ;adresse de la pro-
>0803	0a 00		         .word $0a   ;no. ligne basic.
>0805	9e		         .byte $9e   ;jeton pour la
>0806	32 30 36 31	         .text "2061";adresse du debut
>080a	00		         .byte $00   ;fin de cmd basic.
>080b	00 00		bcmd2    .word $00   ;adresse de la pro-
.080d	20 14 08	         jsr initscr
.0810	20 2d 08	         jsr main
.0813	60		         rts
.0814			initscr
.0814	08		         php
.0815	48		         pha
.0816	a9 05		bord     lda #$05    ;place la couleur
.0818	8d 20 d0	         sta $d020   ; de la bordure.
.081b	a9 06		back     lda #$06    ;place la couleur
.081d	8d 21 d0	         sta $d021   ; du fond d'ecran.
.0820	a9 01		text     lda #$01    ;place la couleur
.0822	8d 86 02	         sta $0286   ; du texte.
.0825	a9 93		         lda #$93    ;efface l'ecran par
.0827	20 d2 ff	         jsr chrout  ; chrout du kernal.
.082a	68		         pla
.082b	28		         plp
.082c	60		         rts

;******  Return to file: prog.asm

.082d			main
.082d	20 0c 0c	         jsr anykey
.0830	a2 00		loopit   ldx #0
.0832	a0 00		posy     ldy #0
.0834	20 5f 0b	         jsr gotoxy
.0837	a2 00		loadx    ldx #$00
.0839	8e 20 d0	         stx $d020
.083c	a9 ff		loada    lda #$ff
.083e	8d 20 d0	         sta $d020
.0841	20 cd bd	         jsr fiaxtf1
.0844	ee 38 08	         inc loadx+1
.0847	d0 e7		         bne loopit
.0849	ee 3d 08	         inc loada+1
.084c	d0 e2		         bne loopit
.084e	ee 33 08	         inc posy+1
.0851	ad 33 08	         lda posy+1
.0854	c9 19		         cmp #25
.0856	30 d8		         bmi loopit
.0858	60		         rts
.0859	a2 c8		         ldx #200
.085b	a0 96		         ldy #150
.085d	20 3a 09	         jsr calcdot
.0860	ad 82 09	         lda col
.0863	20 c5 08	         jsr putahexdec
.0866	20 0c 0c	         jsr anykey
.0869	08		         php
.086a	48		         pha
.086b	a9 0d		         lda #$0d
.086d	20 d2 ff	         jsr chrout
.0870	68		         pla
.0871	28		         plp
.0872	ad 81 09	         lda row
.0875	20 c5 08	         jsr putahexdec
.0878	20 0c 0c	         jsr anykey
.087b	08		         php
.087c	48		         pha
.087d	a9 0d		         lda #$0d
.087f	20 d2 ff	         jsr chrout
.0882	68		         pla
.0883	28		         plp
.0884	ad 83 09	         lda lin
.0887	20 c5 08	         jsr putahexdec
.088a	20 0c 0c	         jsr anykey
.088d	08		         php
.088e	48		         pha
.088f	a9 0d		         lda #$0d
.0891	20 d2 ff	         jsr chrout
.0894	68		         pla
.0895	28		         plp
.0896	ad 84 09	         lda sbit
.0899	20 c5 08	         jsr putahexdec
.089c	20 0c 0c	         jsr anykey
.089f	08		         php
.08a0	48		         pha
.08a1	a9 0d		         lda #$0d
.08a3	20 d2 ff	         jsr chrout
.08a6	68		         pla
.08a7	28		         plp
.08a8	20 64 09	         jsr floattest
.08ab	20 0c 0c	         jsr anykey
.08ae	08		         php
.08af	48		         pha
.08b0	a9 0d		         lda #$0d
.08b2	20 d2 ff	         jsr chrout
.08b5	68		         pla
.08b6	28		         plp
.08b7	60		         rts
>08b8	48 45 4c 4c	chaine .null "hello world!"
>08bc	4f 20 57 4f 52 4c 44 21 00
.08c5			putahexdec
.08c5	20 f9 09	         jsr pushregs
.08c8	48		         pha
.08c9	a9 9e		         lda #kjaune
.08cb	20 d2 ff	         jsr chrout
.08ce	68		         pla
.08cf	20 a3 0a	         jsr putahex
.08d2	48		         pha
.08d3	a9 20		         lda #$20
.08d5	20 d2 ff	         jsr chrout
.08d8	68		         pla
.08d9	aa		         tax
.08da	a9 00		         lda #$00
.08dc	20 cd bd	         jsr fiaxtf1
.08df	20 28 0a	         jsr popregs
.08e2	60		         rts
.08e3			bmapinit
.08e3	08		         php
.08e4	48		         pha
.08e5	ad 18 d0	         lda vic+$18
.08e8	09 08		         ora #$08
.08ea	8d 18 d0	         sta vic+$18
.08ed	ad 11 d0	         lda vic+$11
.08f0	09 20		         ora #$20
.08f2	8d 11 d0	         sta vic+$11
.08f5	68		         pla
.08f6	28		         plp
.08f7	60		         rts
.08f8			bmapclr
.08f8	20 8b 09	         jsr pushall
.08fb	a9 00		         lda #<vidstart
.08fd	85 fb		         sta zp1
.08ff	a9 20		         lda #>vidstart
.0901	85 fc		         sta zp1+1
.0903	a0 00		         ldy #$00
.0905	a9 00		more     lda #$00
.0907	91 fb		         sta (zp1),y
.0909	20 4f 0a	         jsr inczp1
.090c	a5 fc		         lda zp1+1
.090e	c9 3f		         cmp #$3f
.0910	d0 f3		         bne more
.0912	a5 fb		         lda zp1
.0914	c9 3f		         cmp #$3f
.0916	d0 ed		         bne more
.0918	20 c6 09	         jsr popall
.091b	60		         rts
.091c			bmpfillbk
.091c	20 8b 09	         jsr pushall
.091f	a9 00		         lda #<bakmem
.0921	85 fb		         sta zp1
.0923	a9 04		         lda #>bakmem
.0925	85 fc		         sta zp1+1
.0927	a2 08		         ldx #$08
.0929	a0 00		         ldy #$00
.092b	a9 01		         lda #$01
.092d	91 fb		more     sta (zp1),y
.092f	20 4f 0a	         jsr inczp1
.0932	e4 fc		         cpx zp1+1
.0934	d0 f7		         bne more
.0936	20 c6 09	         jsr popall
.0939	60		         rts
.093a			calcdot
.093a	20 8b 09	         jsr pushall
.093d	98		         tya     ;y contien la ligne
.093e	4a		         lsr a   ; on divise par 8
.093f	4a		         lsr a
.0940	4a		         lsr a
.0941	8d 81 09	         sta row ; et on sauvegarde
.0944	8a		         txa     ;x contien la colonne
.0945	4a		         lsr a   ; on divise par 8
.0946	4a		         lsr a
.0947	4a		         lsr a
.0948	8d 82 09	         sta col ; et on sauvegarde
.094b	98		         tya     ; masque avec 7 donne
.094c	29 07		         and #$07; la ligne caractere
.094e	8d 83 09	         sta lin ; du pixel.
.0951	8a		         txa     ;7-(x and 7) donne le
.0952	29 07		         and #$07; no du bit de l'octet
.0954	8d 84 09	         sta sbit; du pixel.
.0957	a9 07		         lda #$07
.0959	38		         sec
.095a	ed 84 09	         sbc sbit
.095d	8d 84 09	         sta sbit
.0960	20 c6 09	         jsr popall
.0963	60		         rts
.0964			floattest
.0964	08		         php
.0965	48		         pha
.0966	a9 07		         lda #$07
.0968	8d 86 02	         sta kcol
.096b	ac 84 09	         ldy sbit
.096e	20 a2 b3	         jsr fiyytf1
.0971	a9 03		         lda #$03
.0973	8d 86 02	         sta kcol
.0976	20 b2 0b	         jsr prnfac1
.0979	a9 01		         lda #$01
.097b	8d 86 02	         sta kcol
.097e	68		         pla
.097f	28		         plp
.0980	60		         rts
>0981	00		row      .byte $00
>0982	00		col      .byte $00
>0983	00		lin      .byte $00
>0984	55		sbit     .byte $55
>0985	00 00		adrs     .word $00
>0987	00 20		baseaddr .word $2000 ;8192
>0989	40 01		scrwidth .word $0140 ;320

;******  Processing file: l-push.asm

.098b			pushall
.098b	08		         php     ;s;p,pcl,pch
.098c	78		         sei
.098d	8d a8 02	         sta ra  ;save a
.0990	68		         pla     ;s:pcl,pch
.0991	8d a7 02	         sta rp  ;save rp
.0994	68		         pla     ;s:pch
.0995	8d a9 02	         sta pc  ;save pcl
.0998	68		         pla     ;s:
.0999	8d aa 02	         sta pc+1;save pch
.099c	a5 fb		         lda $fb ;save fb
.099e	48		         pha     ;s:fb
.099f	a5 fc		         lda $fc ;save fc
.09a1	48		         pha     ;s:fc,fb
.09a2	a5 fd		         lda $fd ;save fd
.09a4	48		         pha     ;s:fd,fc,fb
.09a5	a5 fe		         lda $fe ;save fe
.09a7	48		         pha     ;s:fe,fd,fc,fb
.09a8	ad a7 02	         lda rp  ;save rp
.09ab	48		         pha     ;s:rp,fe,fd,fc,fb
.09ac	ad a8 02	         lda ra  ;save ra
.09af	48		         pha     ;s:ra,rp,fe,fd,fc,fb
.09b0	8a		         txa     ;save rx
.09b1	48		         pha     ;s:rx,ra,rp,fe-fb
.09b2	98		         tya     ;save y
.09b3	48		         pha     ;s:ry,rx,ra,rp,fe-fb
.09b4	ad aa 02	         lda pc+1;replace l'adresse
.09b7	48		         pha     ;s:pch,ry,rx,ra,...
.09b8	ad a9 02	         lda pc  ; de retour.
.09bb	48		         pha     ;s:pcl,pch,ru,rx,ra,...
.09bc	ad a7 02	         lda rp  ;place les flags
.09bf	48		         pha     ; sur le stack.
.09c0	ad a8 02	         lda ra  ;recupere ra
.09c3	28		         plp     ;recupere les flags.
.09c4	58		         cli
.09c5	60		         rts
.09c6			popall
.09c6	78		         sei     ;s:pcl,pch,ry,rx,...
.09c7	68		         pla     ;s:pch,ry,rx,ra,rp,...
.09c8	8d a9 02	         sta pc  ;sauve pcl
.09cb	68		         pla     ;s:ry,rx,ra,rp,fe...fb
.09cc	8d aa 02	         sta pc+1;sauve pch
.09cf	68		         pla     ;s:rx,ra,rp,fe,fd,fc,fb
.09d0	a8		         tay     ;recupere ry
.09d1	68		         pla     ;s:ra,rp,fe,fd,fc,fb
.09d2	aa		         tax     ;recupere rx
.09d3	68		         pla     ;s:rp,fe,fd,fc,fb
.09d4	8d a8 02	         sta ra  ;recupere ra
.09d7	68		         pla     ;s:fe,fd,fc,fb
.09d8	8d a7 02	         sta rp  ;recupere les flags.
.09db	68		         pla     ;s:fd,fc,fb
.09dc	85 fe		         sta $fe ;reccupere fe
.09de	68		         pla     ;s:fc,fb
.09df	85 fd		         sta $fd ;recupere fd
.09e1	68		         pla     ;s:fb
.09e2	85 fc		         sta $fc ;recupere fc
.09e4	68		         pla     ;s:
.09e5	85 fb		         sta $fb ;recupere fb
.09e7	ad aa 02	         lda pc+1;replaace l'adresse de
.09ea	48		         pha     ;s:pch
.09eb	ad a9 02	         lda pc  ;retour sur la pile
.09ee	48		         pha     ;s:pcl,pch
.09ef	ad a7 02	         lda rp  ;recupere les flags
.09f2	48		         pha     ;s:rp,pcl,pch
.09f3	ad a8 02	         lda ra  ;recupere ra
.09f6	58		         cli     ;
.09f7	28		         plp     ;s:pcl,pch
.09f8	60		         rts
.09f9			pushregs
.09f9	08		         php     ;s;p,pcl,pch
.09fa	78		         sei
.09fb	8d a8 02	         sta ra  ;save a
.09fe	68		         pla     ;s:pcl,pch
.09ff	8d a7 02	         sta rp  ;save rp
.0a02	68		         pla     ;s:pch
.0a03	8d a9 02	         sta pc  ;save pcl
.0a06	68		         pla     ;s:
.0a07	8d aa 02	         sta pc+1;save pch
.0a0a	ad a7 02	         lda rp  ;save rp
.0a0d	48		         pha     ;s:rp
.0a0e	ad a8 02	         lda ra  ;save ra
.0a11	48		         pha     ;s:ra,rp
.0a12	8a		         txa     ;save rx
.0a13	48		         pha     ;s:rx,ra,rp
.0a14	98		         tya     ;save y
.0a15	48		         pha     ;s:ry,rx,ra,rp
.0a16	ad aa 02	         lda pc+1;replace l'adresse
.0a19	48		         pha     ;s:pch,ry,rx,ra,rp
.0a1a	ad a9 02	         lda pc  ; de retour.
.0a1d	48		         pha     ;s:pcl,pch,ru,rx,ra,rp
.0a1e	ad a7 02	         lda rp  ;place les flags
.0a21	48		         pha     ; sur le stack.
.0a22	ad a8 02	         lda ra  ;recupere ra
.0a25	28		         plp     ;recupere les flags.
.0a26	58		         cli
.0a27	60		         rts
.0a28			popregs
.0a28	78		         sei     ;s:pcl,pch,ry,rx,ra,rp
.0a29	68		         pla     ;s:pch,ry,rx,ra,rp
.0a2a	8d a9 02	         sta pc  ;sauve pcl
.0a2d	68		         pla     ;s:ry,rx,ra,rp
.0a2e	8d aa 02	         sta pc+1;sauve pch
.0a31	68		         pla     ;s:rx,ra,rp
.0a32	a8		         tay     ;recupere ry
.0a33	68		         pla     ;s:ra,rp
.0a34	aa		         tax     ;recupere rx
.0a35	68		         pla     ;s:rp
.0a36	8d a8 02	         sta ra  ;recupere ra
.0a39	68		         pla     ;s:
.0a3a	8d a7 02	         sta rp  ;recupere les flags.
.0a3d	ad aa 02	         lda pc+1;replaace l'adresse de
.0a40	48		         pha     ;s:pch
.0a41	ad a9 02	         lda pc  ;retour sur la pile
.0a44	48		         pha     ;s:pcl,pch
.0a45	ad a7 02	         lda rp  ;recupere les flags
.0a48	48		         pha     ;s:rp,pcl,pch
.0a49	ad a8 02	         lda ra  ;recupere ra
.0a4c	58		         cli     ;
.0a4d	28		         plp     ;s:pcl,pch
.0a4e	60		         rts

;******  Return to file: prog.asm


;******  Processing file: l-mem.asm

.0a4f			inczp1
.0a4f	08		         php
.0a50	e6 fb		         inc zp1
.0a52	d0 02		         bne repzp1
.0a54	e6 fc		         inc zp1+1
.0a56	28		repzp1   plp
.0a57	60		         rts
.0a58			inczp2
.0a58	08		         php
.0a59	e6 fd		         inc zp2
.0a5b	d0 02		         bne repzp2
.0a5d	e6 fe		         inc zp2+1
.0a5f	28		repzp2   plp
.0a60	60		         rts
.0a61			deczp1
.0a61	08		         php
.0a62	48		         pha
.0a63	c6 fb		         dec zp1
.0a65	a5 fb		         lda zp1
.0a67	c9 ff		         cmp #$ff
.0a69	d0 02		         bne pullzp1
.0a6b	c6 fc		         dec zp1+1
.0a6d	68		pullzp1  pla
.0a6e	28		         plp
.0a6f	60		         rts
.0a70			deczp2
.0a70	08		         php
.0a71	48		         pha
.0a72	c6 fd		         dec zp2
.0a74	a5 fd		         lda zp2
.0a76	c9 ff		         cmp #$ff
.0a78	d0 02		         bne pullzp2
.0a7a	c6 fe		         dec zp2+1
.0a7c	68		pullzp2  pla
.0a7d	28		         plp
.0a7e	60		         rts

;******  Return to file: prog.asm


;******  Processing file: l-conv.asm

.0a7f			putyxhex
.0a7f	20 8b 09	         jsr pushall
.0a82	98		         tya
.0a83	48		         pha
.0a84	20 d8 0a	         jsr lsr4bits
.0a87	20 df 0a	         jsr nibtohex
.0a8a	8d ef 0a	         sta hexstr+0
.0a8d	68		         pla
.0a8e	20 df 0a	         jsr nibtohex
.0a91	8d f0 0a	         sta hexstr+1
.0a94	8a		         txa
.0a95	20 bd 0a	         jsr atohex
.0a98	a2 ef		         ldx #<hexstr+0
.0a9a	a0 0a		         ldy #>hexstr+0
.0a9c	20 1f 0b	         jsr putsyx
.0a9f	20 c6 09	         jsr popall
.0aa2	60		         rts
.0aa3			putahex
.0aa3	08		         php
.0aa4	48		         pha
.0aa5	8d bc 0a	         sta thisra
.0aa8	98		         tya
.0aa9	48		         pha
.0aaa	ad bc 0a	         lda thisra
.0aad	20 bd 0a	         jsr atohex
.0ab0	a2 f1		         ldx #<hexstr+2
.0ab2	a0 0a		         ldy #>hexstr+2
.0ab4	20 1f 0b	         jsr putsyx
.0ab7	68		         pla
.0ab8	a8		         tay
.0ab9	68		         pla
.0aba	28		         plp
.0abb	60		         rts
>0abc	00		thisra   .byte $00
.0abd			atohex
.0abd	08		         php
.0abe	48		         pha
.0abf	48		         pha
.0ac0	20 d8 0a	         jsr lsr4bits
.0ac3	20 df 0a	         jsr nibtohex
.0ac6	8d f1 0a	         sta hexstr+2
.0ac9	68		         pla
.0aca	20 df 0a	         jsr nibtohex
.0acd	8d f2 0a	         sta hexstr+3
.0ad0	a9 00		         lda #$00
.0ad2	8d f3 0a	         sta hexstr+4
.0ad5	68		         pla
.0ad6	28		         plp
.0ad7	60		         rts
.0ad8			lsr4bits
.0ad8	08		         php
.0ad9	4a		         lsr a
.0ada	4a		         lsr a
.0adb	4a		         lsr a
.0adc	4a		         lsr a
.0add	28		         plp
.0ade	60		         rts
.0adf			nibtohex
.0adf	08		         php
.0ae0	29 0f		         and #$0f
.0ae2	f8		         sed
.0ae3	18		         clc
.0ae4	69 90		         adc #$90
.0ae6	69 40		         adc #$40
.0ae8	d8		         cld
.0ae9	28		         plp
.0aea	60		         rts
>0aeb	01		a2hexcol .byte $01
.0aec			a2hexpos
>0aec	01		a2hexpx  .byte $01
>0aed	01		a2hexpy  .byte $01
>0aee	24		a2hexpfx .byte 36
>0aef	00 00 00 00	hexstr   .byte $00,$00,$00,$00,$00
>0af3	00
>0af4	01		a2bincol .byte $01
.0af5			a2binpos
>0af5	01		a2binpx  .byte $01
>0af6	01		a2binpy  .byte $01
>0af7	25		a2binpfx .byte 37
>0af8	30 30 30 30	binstr   .null "00000000"
>0afc	30 30 30 30 00
>0b01	01		a2deccol .byte $01
.0b02			a2decpos
>0b02	01		a2decpx  .byte $01
>0b03	01		a2decpy  .byte $01
>0b04	25		a2decpfx .byte 37
>0b05	30 30 30 30	decstr   .null "00000"
>0b09	30 00

;******  Return to file: prog.asm


;******  Processing file: l-string.asm

.0b0b			puts
.0b0b	20 8b 09	         jsr pushall
.0b0e	a0 00		         ldy #$00   ; y = offset
.0b10	b1 fb		nextc    lda ($fb),y;lit un caractere
.0b12	f0 07		         beq out    ;si 0 on sort
.0b14	20 d2 ff	         jsr chrout ;on l'affiche
.0b17	c8		         iny        ;pointe le prochain
.0b18	4c 10 0b	         jmp nextc  ; et l'affiche
.0b1b	20 c6 09	out      jsr popall
.0b1e	60		         rts
.0b1f			putsyx
.0b1f	20 8b 09	         jsr pushall;sauve reg + zps
.0b22	86 fb		         stx $fb    ;$yyxx dans
.0b24	84 fc		         sty $fb+1  ; zp1
.0b26	20 0b 0b	         jsr puts
.0b29	20 c6 09	         jsr popall ;recup reg + zps
.0b2c	60		         rts
.0b2d			putsc
.0b2d	08		         php        ;flag sur stack
.0b2e	48		         pha        ;acc sur stack
.0b2f	48		         pha        ;sauvegarde acc
.0b30	ad 86 02	         lda kcol   ;recup coul. carac.
.0b33	8d ab 02	         sta curcol ; et la sauvegarde
.0b36	68		         pla        ;recup. acc
.0b37	8d 86 02	         sta kcol   ;place coul. voulue
.0b3a	20 0b 0b	         jsr puts   ;affiche la chaine
.0b3d	ad ab 02	         lda curcol ;recup coul. carac.
.0b40	8d 86 02	         sta kcol   ; et la replace
.0b43	68		         pla        ;recup acc
.0b44	28		         plp        ;recup flag
.0b45	60		         rts
.0b46			putxcxy
.0b46	08		         php       ;sauve registres
.0b47	48		         pha       ; ...
.0b48	48		         pha       ;sauve acc
.0b49	ad 86 02	         lda kcol  ;recup couleur carac.
.0b4c	8d ab 02	         sta curcol; et sauvegarde
.0b4f	68		         pla       ;recup acc
.0b50	8d 86 02	         sta kcol  ;place couleur carac.
.0b53	20 1f 0b	         jsr putsyx;affiche la chaine
.0b56	ad ab 02	         lda curcol
.0b59	8d 86 02	         sta kcol
.0b5c	68		         pla
.0b5d	28		         plp
.0b5e	60		         rts
.0b5f			gotoxy
.0b5f	20 f9 09	        jsr pushregs
.0b62	8a		        txa
.0b63	48		        pha
.0b64	98		        tya
.0b65	aa		        tax
.0b66	68		        pla
.0b67	a8		        tay
.0b68	c0 00		txlow   cpy #0
.0b6a	10 02		        bpl txhigh
.0b6c	a2 00		        ldx #0
.0b6e	e0 28		txhigh  cpx #40
.0b70	30 02		        bmi tylow
.0b72	a2 27		        ldx #39
.0b74	c0 00		tylow   cpy #0
.0b76	10 02		        bpl tyhigh
.0b78	a0 00		        ldy #0
.0b7a	c0 19		tyhigh  cpy #25
.0b7c	30 02		        bmi allok
.0b7e	a0 18		        ldy #24
.0b80	18		allok   clc
.0b81	20 f0 ff	        jsr plot
.0b84	20 28 0a	        jsr popregs
.0b87	60		        rts

;******  Return to file: prog.asm


;******  Processing file: l-float.asm

.0b88			clrbasbuf
.0b88	08		         php
.0b89	48		         pha
.0b8a	98		         tya
.0b8b	48		         pha
.0b8c	a9 00		         lda #$00
.0b8e	a0 59		         ldy #$59
.0b90	99 00 02	again    sta $0200,y
.0b93	88		         dey
.0b94	d0 fa		         bne again
.0b96	68		         pla
.0b97	a8		         tay
.0b98	68		         pla
.0b99	28		         plp
.0b9a	60		         rts
.0b9b			getfac1
.0b9b	20 f9 09	         jsr pushregs
.0b9e	20 88 0b	         jsr clrbasbuf
.0ba1	20 f9 ab	         jsr prompt
.0ba4	86 7a		         stx $7a
.0ba6	84 7b		         sty $7b
.0ba8	20 73 00	         jsr chrget
.0bab	20 f3 bc	         jsr fasctf1 ;conv. ascii->float
.0bae	20 28 0a	         jsr popregs
.0bb1	60		         rts
.0bb2			prnfac1
.0bb2	20 f9 09	         jsr pushregs
.0bb5	20 dd bd	         jsr ff1tasc
.0bb8	a0 01		         ldy #>fascii
.0bba	a2 00		         ldx #<fascii
.0bbc	20 1f 0b	         jsr putsyx
.0bbf	20 28 0a	         jsr popregs
.0bc2	60		         rts
>0bc3	00 00 00 00	fvar1    .word $00,$00,$00
>0bc7	00 00
>0bc9	00 00 00 00	fvar2    .word $00,$00,$00
>0bcd	00 00
>0bcf	20 20 20 20	float1   .null "                 "
>0bd3	20 20 20 20 20 20 20 20 20 20 20 20 20 00
>0be1	20 20 20 20	float2   .null "                 "
>0be5	20 20 20 20 20 20 20 20 20 20 20 20 20 00
>0bf3	55		tval1    .byte $55
>0bf4	40 01		tval2    .word 320

;******  Return to file: prog.asm


;******  Processing file: l-keyb.asm

.0bf6			clrkbbuf
.0bf6	08		            php
.0bf7	48		            pha
.0bf8	a9 00		            lda #0
.0bfa	85 c6		            sta 198
.0bfc	68		            pla
.0bfd	28		            plp
.0bfe	60		            rts
.0bff			waitstop
.0bff	08		          php    ;\ sauve les flags
.0c00	48		          pha    ;/  et l'acc.
.0c01	20 f6 0b	          jsr clrkbbuf
.0c04	20 ed f6	wait      jsr k_stop  ; Veri [run/stop]
.0c07	d0 fb		          bne  wait   ;loop pas pesee.
.0c09	68		          pla    ;\ recup. acc et
.0c0a	28		          plp    ;/  les flags.
.0c0b	60		          rts
.0c0c			anykey
.0c0c	08		        php     ;\ sauve les flags
.0c0d	48		        pha     ;/  et l'acc.
.0c0e	20 f6 0b	        jsr clrkbbuf
.0c11	a5 cb		wait    lda 203 ;lit la matrice de
.0c13	c9 40		        cmp #64 ; si 64 alors aucune
.0c15	f0 fa		        beq wait; on attend qu'il y
.0c17	20 20 0c	        jsr kbfree ; on attend que
.0c1a	20 f6 0b	        jsr clrkbbuf
.0c1d	68		        pla     ;\ recup. l'acc et
.0c1e	28		        plp     ;/  les flags.
.0c1f	60		        rts
.0c20			kbfree
.0c20	08		            php     ;\ sauve les flags
.0c21	48		            pha     ;/  et l'acc.
.0c22	a5 cb		wait        lda 203 ;lit la matrice de
.0c24	c9 40		            cmp #64 ; si 64 alors aucune
.0c26	d0 fa		            bne wait;on attend qu'il y
.0c28	68		            pla     ;\ recup. l'acc et
.0c29	28		            plp     ;/  les flags.
.0c2a	60		            rts
.0c2b			getkey
.0c2b	08		            php     ; sauve les flags.
.0c2c	20 e4 ff	try         jsr getin ;tente de lire
.0c2f	c9 00		            cmp #0  ; 0 si aucune.
.0c31	f0 f9		            beq try ; aucune, on attend.
.0c33	28		            plp     ; recup. les flags.
.0c34	60		            rts
.0c35			waitkey
.0c35	08		            php      ;\ sauve les flags
.0c36	48		            pha      ;/  et l'acc.
.0c37	8d 51 0c	            sta clef ; sauve cle voulue.
.0c3a	20 f6 0b	            jsr clrkbbuf
.0c3d	20 e4 ff	wait        jsr getin; tente lire clef.
.0c40	cd 51 0c	            cmp clef ;compare avec clef
.0c43	d0 f8		            bne wait ;pas la bonne.
.0c45	68		            pla      ;\ recup. l'acc et
.0c46	28		            plp      ;/  les flags.
.0c47	60		            rts
.0c48			waitspace
.0c48	a9 20		            lda #$20
.0c4a	20 35 0c	            jsr waitkey
.0c4d	20 f6 0b	            jsr clrkbbuf
.0c50	60		            rts
>0c51	00		clef        .byte   0

;******  Return to file: prog.asm


;******  End of listing
