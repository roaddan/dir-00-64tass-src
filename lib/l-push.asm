;---------------------------------------; nom fichier..: l-push.asm (seq); type fichier.: code pour t.m.p.; auteur.......: daniel lafrance; version......: 0.0.1; revision.....: 20251119;---------------------------------------pushall         .block  ;s:pcl,pch         php     ;s;rp,pcl,pch         sta ra  ;sauve a         pla     ;s:pcl,pch         sta rp  ;sauve rp         ;------------------------------         ; adresse de retour presente         pla     ;s:pch         sta pc  ;sauve pcl         pla     ;s:         sta pc+1;sauve pch         ;------------------------------         lda $fb ;sauve fb         pha     ;s:fb         lda $fc ;sauve fc         pha     ;s:fc,fb         lda $fd ;sauve fd         pha     ;s:fd,fc,fb         lda $fe ;sauve fe         pha     ;s:fe,fd,fc,fb         ;------------------------------         lda rp  ;sauve rp         pha     ;s:rp,fe,fd,fc,fb         lda ra  ;sauve ra         pha     ;s:ra,rp,fe,fd,fc,fb         txa     ;sauve rx         pha     ;s:rx,ra,rp,fe-fb         tya     ;sauve y         pha     ;s:ry,rx,ra,rp,fe-fb         ;------------------------------         ; adresse de retour presente         lda pc+1;replace l'adresse         pha     ;s:pch,ry,rx,ra,...         lda pc  ; de retour.         pha     ;s:pcl,pch,ru,rx,ra,...         ;------------------------------         lda rp  ;place les flags         pha     ; sur le stack.         lda ra  ;recupere ra         plp     ;recupere les flags.         rts         .bend;---------------------------------------popall         .block  ;s:pcl,pch,ry,rx,...         php     ;s:rp,pcl,pch,ry,rx,...         sta ra         pla     ;s:pcl,pch,ry,rx,...         sta rp  ;s:pch,ry,rx,ra,rp,...         ;------------------------------         ; adresse de retour presente         pla         sta pc  ;sauve pcl         pla     ;s:ry,rx,ra,rp,fe...fb         sta pc+1;sauve pch         ;------------------------------         pla     ;s:rx,ra,rp,fe,fd,fc,fb         tay     ;recupere ry         pla     ;s:ra,rp,fe,fd,fc,fb         tax     ;recupere rx         pla     ;s:rp,fe,fd,fc,fb         sta ra  ;recupere ra         pla     ;s:fe,fd,fc,fb         sta rp  ;recupere les flags.         ;------------------------------         pla     ;s:fd,fc,fb         sta $fe ;reccupere fe         pla     ;s:fc,fb         sta $fd ;recupere fd         pla     ;s:fb         sta $fc ;recupere fc         pla     ;s:         sta $fb ;recupere fb         ;------------------------------         ; adresse de retour presente         lda pc+1;replaace l'adresse de         pha     ;s:pch         lda pc  ;retour sur la pile         pha     ;s:pcl,pch         ;------------------------------         lda rp  ;recupere les flags         pha     ;s:rp,pcl,pch         lda ra  ;recupere ra         plp     ;s:pcl,pch         rts         .bend;---------------------------------------pushregs         .block  ;s:pcl,pch         php     ;s;rp,pcl,pch         sta ra  ; -- sauve a         pla     ;s:pcl,pch         sta rp  ; -- sauve rp         ;------------------------------         ; adresse de retour presente         pla     ;s:pch         sta pc  ; -- sauve pcl         pla     ;s:         sta pc+1; -- sauve pch         ;------------------------------         lda rp  ; -- sauve rp         pha     ;s:rp         lda ra  ; -- sauve ra         pha     ;s:ra,rp         txa     ; -- tfr rx         pha     ;s:rx,ra,rp         tya     ; -- tfr ry         pha     ;s:ry,rx,ra,rp         ;------------------------------         ; adresse de retour presente         lda pc+1; -- replace l'adresse         pha     ;s:pch,ry,rx,ra,rp         lda pc  ; -- de retour.         pha     ;s:pcl,pch,ru,rx,ra,rp         ;------------------------------         lda rp  ; -- place les flags         pha     ;    sur le stack.         lda ra  ; -- recupere ra         plp     ; -- recupere flags.         rts     ;s:pcl,pch,ru,rx,ra,rp         .bend;---------------------------------------popregs         .block         php         sta ra         pla         sta rp         ;------------------------------         ; adresse de retour presente         pla     ;s:pch,ry,rx,ra,rp         sta pc  ; -- sauve pcl         pla     ;s:ry,rx,ra,rp         sta pc+1; -- sauve pch         ;------------------------------         pla     ;s:rx,ra,rp         tay     ;recupere ry         pla     ;s:ra,rp         tax     ;recupere rx         pla     ;s:rp         sta ra  ;recupere ra         pla     ;s:         sta rp  ;recupere les flags.         ;------------------------------         ; adresse de retour presente         lda pc+1;replace l'adresse de         pha     ;s:pch         lda pc  ;retour sur la pile         pha     ;s:pcl,pch         ;------------------------------         lda rp  ;recupere les flags         pha     ;s:rp,pcl,pch         lda ra  ;recupere ra         plp     ;s:pcl,pch         rts         .bend;---------------------------------------