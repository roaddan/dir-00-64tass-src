;---------------------------------------; nom fichier..: l-conv.asm (seq); type fichier.: code; auteur.......: daniel lafrance; version......: 1.0.1; revision.....: 20251117;---------------------------------------; routines d'affichage de chaine de;  caracteres utilisant les routines du;  kernal du ãommodore 64.;---------------------------------------putyxhex         .block         jsr pushall         tya         pha         jsr lsr4bits         jsr nibtohex         sta hexstr+0         pla         jsr nibtohex         sta hexstr+1         txa         jsr atohex         ldx #<hexstr+0         ldy #>hexstr+0         jsr putsyx         jsr popall         rts         .bend;---------------------------------------putahex         .block         jsr pushregs         jsr atohex         ldx #<hexstr+2         ldy #>hexstr+2         jsr putsyx         jsr popregs         rts         .bend;---------------------------------------atohex         .block         php         pha         pha         jsr lsr4bits         jsr nibtohex         sta hexstr+2         pla         jsr nibtohex         sta hexstr+3         lda #$00         sta hexstr+4         pla         plp         rts         .bend;---------------------------------------lsr4bits         .block         php         lsr a         lsr a         lsr a         lsr a         plp         rts         .bend;---------------------------------------nibtohex         .block         php         and #$0f         sed         clc         adc #$90         adc #$40         plp         rts         .bend;---------------------------------------;$(yyxx)= adresse du premier octet.;Acc    = le nombre d'octets.bytestohex         .block         jsr pushall         sty zp1+1         stx zp1         #outcar 32         #outcar 5         #outcar 36         jsr putyxhex   ; prn adresse         #outcar $20         #outcar 159         ldy #$00         taxanother  sty offset         lda (zp1),y         jsr putahex         pha         jsr petsciiaddr         plapetscii  sta $0400         pha         lda #$0dpetcol   sta $d800                  pla         #outcar $20         iny         dex         bne another         ;#outcar 36         ;jsr putyxhex         jsr popall         rts;---------------------------------------; Routine qui modifie le code precedent;---------------------------------------petsciiaddr        jsr pushregs        #ldyxptr scrnlin         ;jsr putyxhex        lda #31        clc        adc offset        jsr addatoyx        sty petscii+2        stx petscii+1        stx petcol+1        tya        and #%11111011 ;#%00000100        ora #$d8        sta petcol+2        tay        ;#outcar $0d        ;jsr putyxhex        jsr popregs        rtsoffset  .byte $00        .bend;---------------------------------------