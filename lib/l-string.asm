;---------------------------------------; nom fichier..: l-string.asm (seq); type fichier.: code pour t.m.p.; auteur.......: daniel lafrance; version......: 0.0.2; revision.....: 20251119,20251121;---------------------------------------; description:; routines d'affichage de chaines de; caracteres se terminant par $00 sans; recours au rom du Basic 2.0.;---------------------------------------; Decommentez les 4 lignes suivantes; pour tester:;---------------------------------------;          .include "e-64map.asm";          .include "e-vars.asm";          .include "e-float.asm";          .include "l-push.asm";---------------------------------------; Affiche une chaine pointee par $FBFCputs;---------------------------------------         .block         jsr pushregs         ldy #$00   ; y = offsetnextc    lda ($fb),y;lit un caractere         beq out    ;si 0 on sort         jsr chrout ;on l'affiche         iny        ;pointe le prochain         jmp nextc  ; et l'afficheout      jsr popregs         rts         .bend;---------------------------------------; Affiche une chaine pointee par $yyxxputsyx;---------------------------------------         .block         jsr pushall;sauve reg + zps         stx $fb    ;$yyxx dans         sty $fb+1  ; zp1         jsr puts         jsr popall ;recup reg + zps         rts         .bend;---------------------------------------; Affiche une chaine $fcfb, couleur->Aputsc;---------------------------------------         .block         php        ;flag sur stack         pha        ;acc sur stack         pha        ;sauvegarde acc         lda kcol   ;recup coul. carac.         sta curcol ; et la sauvegarde         pla        ;recup. acc         sta kcol   ;place coul. voulue         jsr puts   ;affiche la chaine         lda curcol ;recup coul. carac.         sta kcol   ; et la replace         pla        ;recup acc         plp        ;recup flag         rts         .bend;---------------------------------------; Affiche une chaine $yyxx, couleur->aputxcxy;---------------------------------------         .block         php       ;sauve registres         pha       ; ...         pha       ;sauve acc         lda kcol  ;recup couleur carac.         sta curcol; et sauvegarde         pla       ;recup acc         sta kcol  ;place couleur carac.         jsr putsyx;affiche la chaine         lda curcol         sta kcol         pla         plp         rts         .bend;---------------------------------------; Positionne le curseur a l'ecran.; x=colonne, y=ligne; limites x(0-39), Y(0-24)gotoxy;---------------------------------------        .block        jsr pushregs        txa ; interchange x et y        pha ; ...        tya ; ...        tax ; ...        pla ; ...        tay ; ...txlow   cpy #0        bpl txhigh        ldx #0txhigh  cpx #25        bmi tylow        ldx #24tylow   cpy #0        bpl tyhigh        ldy #0tyhigh  cpy #40        bmi allok        ldy #39allok   clc        jsr plot        jsr popregs        rts        .bend;---------------------------------------putnch        .block        jsr pushregsagain   jsr chrout        dex        bne again        jsr popregs        rts        .bend;---------------------------------------